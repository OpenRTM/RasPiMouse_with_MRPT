

<!doctype html>

<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>概要 &#8212; RasPiMouse MRPT  ドキュメント</title>
    <link rel="stylesheet" href="_static/override.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/translations.js"></script>
    <script src="_static/bizstyle.js"></script>
    <link rel="index" title="索引" href="genindex.html" />
    <link rel="search" title="検索" href="search.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <!--[if lt IE 9]>
    <script src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="総合索引"
             accesskey="I">索引</a></li>
        <li class="nav-item nav-item-0"><a href="index.html">RasPiMouse MRPT  ドキュメント</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">概要</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="id1">
<h1>概要<a class="headerlink" href="#id1" title="このヘッドラインへのパーマリンク">¶</a></h1>
<p>このシステムでは、RasPiMouse2019に搭載しているLiDARからの情報をベースに
slamによるナビゲーション地図の作成を行うシステムについて述べます。</p>
<p>このシステムでは、RaspberryPiMouseRTC, RPLidarRTC, Mapper_MRPT, NavigationManagerの4つのRTCを使用します。
また各RTC間の接続は、下図のようになります。</p>
<img alt="_images/mapper.png" src="_images/mapper.png" />
</div>
<div class="section" id="rtc">
<h1>RTCの起動<a class="headerlink" href="#rtc" title="このヘッドラインへのパーマリンク">¶</a></h1>
<p>RTCの起動は、Webブラウザを利用する場合には、トップページの第3セクション &quot;Mapper&quot;の部分を使用します。
ナビゲーションRTCのシステムに対しては、
下図のように「Start」、「Connect」、「Activate」、「Deactivate」、「Stop」の5つのオペレーションがあります。</p>
<img alt="_images/web2.png" src="_images/web2.png" />
<p>ナビゲーション地図作成システムに必要なRTCの起動に「Start」を押下してください。
起動メッセージのページに遷移後、3秒後に自動でトップページに戻ります。</p>
<p>トップページに移行後、第2セクションの  &quot;RTC List&quot; には、現在起動中のRTCの一覧が
表示されますが、RTCによって起動時間が異なりますので、全てのRTCが起動完了するまで
しばらくお待ちください。</p>
<p>NavigationManagerはGUIを伴いますので、おそらく一番最後に起動すると思います。
全てのRTCが起動すると、下図のようなNavigationManagerの操作パネルが表示されます。</p>
<img alt="_images/NavigationManager.png" src="_images/NavigationManager.png" />
<p>また、第2セクションの「List」を押下すると下図のようにRTCのリストが表示されます。</p>
<img alt="_images/mapper-1.png" src="_images/mapper-1.png" />
<p>Webブラウザを使用せずに、ターミナルでRasPiMouse2019にログインする場合には、
下記のコマンドを入力すると上記と同じ結果が得らえます。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ /usr/local/openrtm/bin/mapper.sh start
</pre></div>
</div>
</div>
<div class="section" id="id2">
<h1>ナビゲーション地図生成構築（ポートの接続）<a class="headerlink" href="#id2" title="このヘッドラインへのパーマリンク">¶</a></h1>
<p>必要なRTCの起動後は、ナビゲーション地図作成システムを構成するために、
各RTCのポートの接続を行います。
最終的なシステム構成は、概要で表示した図の通りになります。
この構成を外部のRT System Editorを使って手動で接続しても良いのですが、
第3セクションの「Connect」ボタンを押下することで必要な接続を行うことができます。</p>
<p>ポートの接続後、第2セクションの「List」を押下すると下図のようなリストが得られます。</p>
<img alt="_images/mapper-2.png" src="_images/mapper-2.png" />
<p>また、<a class="reference external" href="https://github.com/haraisao/rtcmd">rtcmd</a> を用いて graphコマンドを実行すると下図のようなシステム構成図を得ることができます。</p>
<img alt="_images/mapper-graph.png" src="_images/mapper-graph.png" />
<p>また、Webブラウザを使用せずに、ターミナルでRasPiMouse2019にログインする場合には、
下記のコマンドを入力すると上記と同じ結果が得らえます。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ /usr/local/openrtm/bin/mapper.sh connect
</pre></div>
</div>
</div>
<div class="section" id="id3">
<h1>ナビゲーション地図生成の実行<a class="headerlink" href="#id3" title="このヘッドラインへのパーマリンク">¶</a></h1>
<p>RTCのポート接続が完了後、ナビゲーション地図作成を行います。
地図生成に係る4つのRTCをアクティベートしてください。</p>
<div class="section" id="id4">
<h2>RTCのアクティベート<a class="headerlink" href="#id4" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>アクティベートの方法は、
Webブラウザ、ターミナルでログイン後にコマンド入力、
クライアントPC上のopenrtp、rtcmd等の外部ツールのいづれかを使用してください。</p>
<p>ここでは、Webブラウザとターミナルでログイン後のコマンドライン入力の2つの方法を紹介します。</p>
<p>Webブラウザでは、第3セクションの「Activation」ボタンを押下することで全てのRTCをアクティベートすることができます。
ターミナルからのコマンドライン入力では、下記のコマンドで同様に全てのRTCをアクティベートすることが可能です。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ /usr/local/openrtm/mapper.sh activate
</pre></div>
</div>
<p>すべてのRTCを有効化すると、下図のようにNavigationManagerの右側のペインに座標軸のみが表示された
空の地図が表示されます。</p>
<img alt="_images/mapper-start.png" src="_images/mapper-start.png" />
<p>現在の設定では、10m x 10mの地図を作成することができます。
より広い地図を作成する必要がある場合には、/usr/local/openrtm/etc/Mapper_MRPT.confのパラメータを
変更してください。</p>
</div>
<div class="section" id="id5">
<h2>ナビゲーション地図の作成<a class="headerlink" href="#id5" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>システムのRTCのアクティベーション後は、
ナビゲーション地図を作成するために NavigationManagerの上部にある
「Start Mapping」ボタンを押下してください。
これによって、下図のようにRasPiMouse2019のLidarの情報を元にナビゲーション地図作成が開始されます。</p>
<img alt="_images/mapper-start2.png" src="_images/mapper-start2.png" />
<p>上図のようにナビゲーション地図作成が開始されれば、NavigationManagerのJoystickパネルを用いて
手動でRasPiMouse2019を移動させてください。</p>
</div>
<div class="section" id="joystick">
<h2>Joystickパネルによる操作<a class="headerlink" href="#joystick" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>NavigationManagerのJoystickは、メニューの [Control] -&gt; [Start Control]を選択することで、
下図のような接続ダイアログが表示されますので、「OK」ボタンで選択してください。</p>
<img alt="_images/start-control.png" src="_images/start-control.png" />
<p>正常にポート接続が完了すれば下図のような仮想Joystickが表示されますので、
RasPiMouse2019を移動させ、ナビゲーション地図を完成させてください。</p>
<img alt="_images/Joystick.png" src="_images/Joystick.png" />
<p>しばらくRasPiMouse2019を移動させると下図のようなナビゲーション地図が得られます。</p>
<img alt="_images/mapper-end.png" src="_images/mapper-end.png" />
</div>
<div class="section" id="id6">
<h2>ナビゲーション地図の保存<a class="headerlink" href="#id6" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>最後に作成したナビゲーション地図を保存します。
NavigationManagerの「Save Mapping」ボタンを押下してください。
ファイル名選択ダイアログが表示されますので、/usr/local/openrtm/testMap.png　と
いう名前で保存してください。</p>
<p>ここで保存したファイル名(testMap)は、
自己位置同定システムや経路生成システムで使用するMapServerのデフォルト値になっています。</p>
</div>
</div>
<div class="section" id="id7">
<h1>ナビゲーション地図生成システムの終了<a class="headerlink" href="#id7" title="このヘッドラインへのパーマリンク">¶</a></h1>
<p>ナビゲーション地図の保存が終了後は、RTCの終了を行います。
RTCの終了はWebブラウザの第3セクションの「Stop」ボタンを押下するか、
ターミナルでログイン後に下記のコマンド入力を行うことで行ってください。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ /usr/local/openrtm/bin/mapper.sh stop
</pre></div>
</div>
<p>上記の例では、「Disconnct」と「Deactivate」を使用しませんでしたが、
起動中のRTCをそのまま使い自己位置同定システム等を実行する場合には
適宜利用することができます。</p>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">クイック検索</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="検索" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script><div id="toc" class="sidebarRow">

    <h4><a href="index.html">目次</a></h4>
        <ul>
<li class="toctree-l1"><a class="reference internal" href="raspbian_setup.html">RaspberryPiMouseセットアップ</a></li>
<li class="toctree-l1"><a class="reference internal" href="install_pkg.html">パッケージインストール</a></li>
<li class="toctree-l1"><a class="reference internal" href="ap_setup.html">RaspberryPiシステム設定</a></li>
<li class="toctree-l1"><a class="reference internal" href="start_rtc.html">RTコンポーネントの起動方法</a></li>
<li class="toctree-l1"><a class="reference internal" href="auto_start.html">RTC自動起動設定</a></li>
<li class="toctree-l1"><a class="reference internal" href="system.html">SLAMによるナビゲーション</a></li>
<li class="toctree-l1"><a class="reference internal" href="build_rtc.html">（付録）RTCのコンパイル</a></li>
</ul>

    
</div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="総合索引"
             >索引</a></li>
        <li class="nav-item nav-item-0"><a href="index.html">RasPiMouse MRPT  ドキュメント</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">概要</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, AIST.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.2.1.
    </div>
  </body>
</html>